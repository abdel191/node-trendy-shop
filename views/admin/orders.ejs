<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Commandes - Admin | TrendyShop</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>

  <body class="bg-gray-100 min-h-screen">
    <%- include("../partials/header") %>

    <div class="container mx-auto px-4 py-10">
      <!-- TITRE -->
      <h1 class="text-3xl font-bold mb-6">üì¶ Gestion des commandes</h1>

      <p class="mb-6 text-gray-700">
        Admin : <strong><%= user.name %></strong>
      </p>

      <!-- NAV -->
      <div class="mb-6 flex gap-4">
        <a href="/admin" class="text-indigo-600 hover:underline">
          ‚Üê Retour dashboard
        </a>
      </div>

      <!-- TABLE COMMANDES -->
      <div class="bg-white rounded shadow p-6 overflow-x-auto">
        <% if (orders.length === 0) { %>
        <p class="text-gray-500">Aucune commande enregistr√©e.</p>
        <% } else { %>
        <table class="w-full border-collapse">
          <thead>
            <tr class="bg-gray-200 text-left">
              <th class="p-3">Commande</th>
              <th class="p-3">Client</th>
              <th class="p-3">Total (‚Ç¨)</th>
              <th class="p-3">Paiement</th>
              <th class="p-3">Statut</th>
              <th class="p-3">Date</th>
              <th class="p-3">Actions</th>
            </tr>
          </thead>

          <tbody>
            <% orders.forEach(order => { %>
            <tr class="border-t hover:bg-gray-50">
              <td class="p-3 font-semibold">#<%= order.id %></td>

              <td class="p-3">
                <% if (order.user) { %> <%= order.user.name %><br />
                <span class="text-sm text-gray-500"
                  ><%= order.user.email %></span
                >
                <% } else { %>
                <span class="italic text-gray-500">Invit√©</span>
                <% } %>
              </td>

              <td class="p-3 font-bold">
                <%= order.totalAmount.toFixed(2) %> ‚Ç¨
              </td>

              <td class="p-3 capitalize"><%= order.paymentMethod %></td>

              <td class="p-3">
                <span
                  class="px-2 py-1 rounded text-sm <%= order.paymentStatus === 'paid' ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700' %>"
                >
                  <%= order.paymentStatus %>
                </span>
              </td>

              <td class="p-3 text-sm">
                <%= new Date(order.createdAt).toLocaleDateString() %>
              </td>

              <td class="p-3">
                <a
                  href="/admin/orders/<%= order.id %>"
                  class="text-indigo-600 hover:underline text-sm"
                >
                  Voir d√©tails ‚Üí
                </a>
              </td>
            </tr>
            <% }) %>
          </tbody>
        </table>
        <% } %>
      </div>
    </div>
  </body>
  <%- include("../partials/footer") %>
</html>
