<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Paiement - Panier</title>

    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
  </head>
  <%- include("../partials/header") %>
  <body class="bg-gray-100">
    <div class="container mx-auto px-4 py-8">
      <h1 class="text-3xl font-bold mb-6 text-center">
        Finalisation du panier
      </h1>

      <!-- LISTE DES PRODUITS -->
      <div class="bg-white p-6 rounded shadow">
        <h2 class="text-xl font-semibold mb-4">Vos produits</h2>

        <% if (cartItems && cartItems.length > 0) { %> <%
        cartItems.forEach((item) => { %>
        <div class="flex justify-between border-b py-3">
          <div>
            <p class="font-semibold"><%= item.product.name %></p>
            <p class="text-sm text-gray-600">Quantité : <%= item.quantity %></p>
          </div>

          <p class="font-semibold">
            <%= (item.product.price * item.quantity).toFixed(2) %> €
          </p>
        </div>
        <% }) %> <% } else { %>

        <p class="text-red-600 font-semibold">Votre panier est vide.</p>

        <% } %>

        <div class="flex justify-between mt-4 text-lg font-bold">
          <span>Total :</span>
          <span><%= total.toFixed(2) %> €</span>
        </div>
      </div>

      <!-- FORMULAIRE DE LIVRAISON -->
      <form
        action="/checkout/process-cart"
        method="POST"
        class="bg-white p-6 rounded shadow mt-6"
      >
        <h2 class="text-xl font-semibold mb-4">Informations de livraison</h2>

        <label class="block mb-2">Nom :</label>
        <input
          type="text"
          name="name"
          required
          class="w-full border p-2 rounded mb-4"
        />

        <label class="block mb-2">Adresse :</label>
        <input
          type="text"
          name="address"
          required
          class="w-full border p-2 rounded mb-4"
        />

        <label class="block mb-2">Ville :</label>
        <input
          type="text"
          name="city"
          required
          class="w-full border p-2 rounded mb-4"
        />

        <label class="block mb-2">Code postal :</label>
        <input
          type="text"
          name="zip"
          required
          class="w-full border p-2 rounded mb-4"
        />

        <input type="hidden" name="total" value="<%= total %>" />

        <button
          class="bg-green-600 text-white py-2 px-6 rounded hover:bg-green-700"
        >
          Procéder au paiement
        </button>

        <a
          href="/checkout/paypal"
          class="bg-yellow-500 text-white py-2 px-6 rounded block text-center mt-4"
        >
          Payer avec PayPal
        </a>
      </form>
    </div>
  </body>
</html>
